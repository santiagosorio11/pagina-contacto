<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contacto Basico - Videos</title>
    <meta name="description" content="Videos de nuestros modelos en Contacto Básico. Descubre las fotos, medidas y detalles de nuestros talentos.">
    <meta name="keywords" content="videos, modelos, fotos de modelos, medidas de modelos, contacto basico">
    <meta property="og:title" content="Contacto Basico - Videos">
    <meta property="og:description" content="Videos de nuestros modelos en Contacto Básico. Descubre las fotos, medidas y detalles de nuestros talentos.">
    <meta property="og:image" content="https://www.contactobasico.com/assets/logo.png">
    <meta property="og:url" content="https://www.contactobasico.com/pages/videos.html">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Contacto Basico - Videos">
    <meta name="twitter:description" content="Videos de nuestros modelos en Contacto Básico. Descubre las fotos, medidas y detalles de nuestros talentos.">
    <meta name="twitter:image" content="https://www.contactobasico.com/assets/logo.png">
    <link rel="icon" href="../assets/logo.png" type="image/png">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/header.css">
    <link rel="stylesheet" href="../css/portfolio.css">
</head>
<body class="subpage" style="visibility: hidden;">
    <header class="main-header">
        <a href="/" class="logo-link">
            <img src="../assets/logo.png" alt="Básico Model Management Logo" class="logo" loading="lazy">
        </a>
        <button class="menu-toggle" aria-label="Toggle navigation menu">
            <span class="hamburger"></span>
        </button>
        <div class="nav-container">
            <nav class="main-nav">
                <button id="backButton" class="back-button" onclick="history.back()" style="font-family: 'Proxima Nova', sans-serif; font-size: .75rem; font-weight: normal; letter-spacing: .05em; color: var(--color-text); background: none; border: none; cursor: pointer; padding: .5rem 0; transition: all .3s ease-in-out; position: relative; text-transform: capitalize;">REGRESAR</button>
                <a href="../pages/women.html" data-translate="nav_women">Women</a>
                <a href="../pages/men.html" data-translate="nav_men">Men</a>
                <a href="../pages/about-us.html" data-translate="nav_about_us">About Us</a>
                <a href="../pages/events.html" data-translate="nav_events">Events</a>
                <a href="../pages/become-a-model.html" data-translate="nav_become_a_model">Become a Model</a>
                <a href="../pages/contact-us.html" data-translate="nav_contact_us">Contact Us</a>
            </nav>
            <div class="language-toggle">
                <button id="current-lang" class="active">
                    <span id="current-lang-text">EN</span>
                </button>
                <div class="language-dropdown" id="language-dropdown">
                    <button id="lang-en" data-lang="en">
                        <span>English</span>
                    </button>
                    <button id="lang-es" data-lang="es">
                        <span>Español</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main id="portfolio-main" class="portfolio-main">
        <img src="../assets/Long-logo.png" alt="Contacto Basico Logo" class="site-title-logo" style="position: relative; top: -30px;" loading="lazy">
        <h1 class="modelNameBook"></h1>
        <!-- Navigation tabs -->
        <div class="portfolio-tabs">
            <a href="portfolio.html?id=" class="portfolio-tab" id="portfolio-tab">Portfolio</a>
            <a href="polaroids.html?id=" class="portfolio-tab" id="polaroids-tab">Polaroids</a>
            <a href="videos.html?id=" class="portfolio-tab active" id="videos-tab">Videos</a>
        </div>
        <div class="videos-container"></div>
        <div class="model-details-container">
            <ul class="modelBookMeasurements"></ul>
        </div>
    </main>

    <footer class="site-footer">
        <div class="footer-bottom">
            <p>&copy; 2025 Contacto Basico. <span data-translate="copyright">All rights reserved.</span></p>
        </div>
    </footer>
    
    <script src="../js/translations.js"></script>
    <script src="../js/main.js"></script>
    <script src="../js/menu.js"></script>
    <script>
        // Override the loadPortfolioPage function to load videos instead
        document.addEventListener('DOMContentLoaded', async function() {
            // Add a small delay to ensure DOM is fully ready
            await new Promise(resolve => setTimeout(resolve, 100));
            
            // Get the page name correctly when pages are in a subdirectory
            const pathParts = window.location.pathname.split("/");
            const page = pathParts[pathParts.length - 1];
            console.log('Current page:', page);
            console.log('Full path:', window.location.pathname);

            if (page === 'videos.html') {
                console.log('Loading videos page');
                await loadVideosPage();
            }

            // Make body visible after content is loaded
            document.body.style.visibility = 'visible';

            /* --- LOGICA PARA OCULTAR HEADER EN SCROLL --- */
            let lastScrollTop = 0;
            const header = document.querySelector('.main-header');

            window.addEventListener('scroll', function() {
                if (!header) return; // No ejecutar en páginas sin el header fijo (como la homepage)

                let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                if (scrollTop > lastScrollTop && scrollTop > header.offsetHeight) {
                    // Scroll hacia abajo
                    header.classList.add('header-hidden');
                } else {
                    // Scroll hacia arriba
                    header.classList.remove('header-hidden');
                }
                lastScrollTop = scrollTop <= 0 ? 0 : scrollTop; // For Mobile or negative scrolling
            });
        });

        // Function to load videos page
        async function loadVideosPage() {
            console.log("loadVideosPage function started");
            const mainContainer = document.getElementById('portfolio-main');
            if (!mainContainer) {
                console.error("Could not find the element with id 'portfolio-main'");
                // Make sure body is visible even if there's an error
                document.body.style.visibility = 'visible';
                return;
            }

            const params = new URLSearchParams(window.location.search);
            const modelId = params.get('id');
            console.log("Model ID from URL:", modelId);

            if (!modelId) {
                mainContainer.innerHTML = '<h1>Model not specified.</h1>';
                // Make sure body is visible
                document.body.style.visibility = 'visible';
                return;
            }

            try {
                console.log("Fetching models.json and translations.json...");
                const [data, translations] = await fetchData(['/json/models.json', '/json/translations.json']);
                console.log("Successfully parsed models.json and translations.json");

                const model = data.models.find(m => m.id === modelId);
                console.log("Found model:", model);

                if (!model) {
                    mainContainer.innerHTML = '<h1>Model not found.</h1>';
                    // Make sure body is visible
                    document.body.style.visibility = 'visible';
                    return;
                }

                document.title = `Contacto Basico - ${model.name} - Videos`;

                // Update tab links with model ID
                document.getElementById('portfolio-tab').href = `portfolio.html?id=${modelId}`;
                document.getElementById('polaroids-tab').href = `polaroids.html?id=${modelId}`;
                document.getElementById('videos-tab').href = `videos.html?id=${modelId}`;

                // Populate Model Name
                const modelNameElement = document.querySelector('.modelNameBook');
                if (modelNameElement) {
                    modelNameElement.textContent = model.name;
                }

                // Populate Model Measurements
                const measurementsList = document.querySelector('.modelBookMeasurements');
                if (measurementsList) {
                    measurementsList.innerHTML = ''; // Clear existing placeholders
                    const currentLang = localStorage.getItem('preferred_language') || detectLanguage();

                    for (const key in model.details) {
                        const value = model.details[key];
                        const measurementItem = document.createElement('div');
                        measurementItem.classList.add('measurement-item');

                        const nameSpan = document.createElement('span');
                        nameSpan.className = 'measurementName';
                        const translationKey = `detail_${key.toLowerCase()}`;
                        nameSpan.setAttribute('data-translation-key', translationKey);
                        const translatedLabel = translations[currentLang][translationKey] || key;
                        nameSpan.textContent = `${translatedLabel}: `;

                        const valueSpan = document.createElement('span');
                        valueSpan.className = 'measurements';

                        valueSpan.textContent = value;
                        measurementItem.classList.add('non-convertible');

                        measurementItem.appendChild(nameSpan);
                        measurementItem.appendChild(valueSpan);
                        measurementsList.appendChild(measurementItem);
                    }
                }

                // Custom Carousel Implementation with Slide Animation for Videos
                const carouselImagesContainer = document.querySelector('.carousel-images');
                const prevButton = document.querySelector('.carousel-button.prev');
                const nextButton = document.querySelector('.carousel-button.next');
                let currentImageIndex = 0;

                if (carouselImagesContainer && model.videos && model.videos.length > 0) {
                    carouselImagesContainer.innerHTML = ''; // Clear existing content

                    const slideElements = [];

                    model.videos.forEach((videoUrl, index) => {
                        console.log("Video URL:", videoUrl);
                        const slideContainer = document.createElement('div');
                        slideContainer.classList.add('carousel-slide');

                        const video = document.createElement('video');
                        video.controls = true;
                        video.preload = 'metadata'; // Load metadata to get dimensions
                        video.style.width = '100%';
                        video.style.height = 'auto';
                        video.style.display = 'block'; // Ensure it takes up space

                        const source = document.createElement('source');
                        source.src = videoUrl;
                        // Determine type based on extension, or provide a common one
                        if (videoUrl.endsWith('.mp4')) {
                            source.type = 'video/mp4';
                        } else if (videoUrl.endsWith('.webm')) {
                            source.type = 'video/webm';
                        } else if (videoUrl.endsWith('.ogg')) {
                            source.type = 'video/ogg';
                        } else {
                            source.type = 'video/mp4'; // Default or fallback
                        }
                        
                        video.appendChild(source);
                        video.textContent = 'Your browser does not support the video tag.'; // Fallback for old browsers

                        slideContainer.appendChild(video);
                        video.load(); // Force load to trigger fetch
                        carouselImagesContainer.appendChild(slideContainer);
                        slideElements.push(slideContainer);
                    });

                    const showSlide = (index) => {
                        slideElements.forEach((slide, i) => {
                            slide.classList.remove('active', 'prev', 'next');
                            const video = slide.querySelector('video');
                            if (video) {
                                video.pause();  // Pause video when not active
                            }
                            if (i === index) {
                                slide.classList.add('active');
                                // Optionally start playing the active video
                                if (video) {
                                    // video.play();
                                }
                            } else if (i < index) {
                                slide.classList.add('prev');
                            } else {
                                slide.classList.add('next');
                            }
                        });

                        if (index === 0) {
                            prevButton.disabled = true;
                            prevButton.style.opacity = '0.5';
                            prevButton.style.cursor = 'not-allowed';
                        } else {
                            prevButton.disabled = false;
                            prevButton.style.opacity = '1';
                            prevButton.style.cursor = 'pointer';
                        }
                        
                        nextButton.disabled = false;
                        nextButton.style.opacity = '1';
                        nextButton.style.cursor = 'pointer';
                    };

                    let currentVideoIndex = 0;

                    const goToNextSlide = () => {
                        if (currentVideoIndex < slideElements.length - 1) {
                            currentVideoIndex++;
                        } else {
                            currentVideoIndex = 0; // Loop back to the first video
                        }
                        showSlide(currentVideoIndex);
                    };

                    const goToPrevSlide = () => {
                        if (currentVideoIndex > 0) {
                            currentVideoIndex--;
                            showSlide(currentVideoIndex);
                        }
                    };

                    prevButton.addEventListener('click', goToPrevSlide);
                    nextButton.addEventListener('click', goToNextSlide);

                    showSlide(currentVideoIndex);

                } else if (carouselImagesContainer) {
                    carouselImagesContainer.innerHTML = '<p>No videos available.</p>';
                }

                console.log("Videos page built successfully");

            } catch (error) {
                mainContainer.innerHTML = '<h1>Error loading videos. Please try again later.</h1>';
                console.error('Fetch error:', error);
            } finally {
                // Always make sure the body is visible
                document.body.style.visibility = 'visible';
            }
        }
    </script>
</body>
</html>
